05-26 19:07:44 model_name: MFSAN
05-26 19:07:44 source: CWRU_0,CWRU_1,CWRU_3
05-26 19:07:44 target: CWRU_2
05-26 19:07:44 data_dir: ./datasets
05-26 19:07:44 train_mode: multi_source
05-26 19:07:44 cuda_device: 0
05-26 19:07:44 save_dir: ./ckpt
05-26 19:07:44 max_epoch: 30
05-26 19:07:44 batch_size: 64
05-26 19:07:44 num_workers: 4
05-26 19:07:44 signal_size: 1024
05-26 19:07:44 random_state: 1
05-26 19:07:44 normlizetype: -1-1
05-26 19:07:44 opt: sgd
05-26 19:07:44 lr: 0.01
05-26 19:07:44 momentum: 0.9
05-26 19:07:44 betas: (0.9, 0.999)
05-26 19:07:44 weight_decay: 0.0005
05-26 19:07:44 lr_scheduler: stepLR
05-26 19:07:44 gamma: 0.2
05-26 19:07:44 steps: 10
05-26 19:07:44 tradeoff: ['exp', 'exp', 'exp']
05-26 19:07:44 dropout: 0.0
05-26 19:07:44 save: True
05-26 19:07:44 load_path: 
05-26 19:07:44 save_path: ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1CWRU_3]To[CWRU_2]_0526-190744
05-26 19:07:44 Detect 10 classes: ['B007', 'B014', 'B021', 'IR007', 'IR014', 'IR021', 'Normal', 'OR007', 'OR014', 'OR021']
05-26 19:07:44 using 1 / 1 gpus
05-26 19:07:47 Source set CWRU_0 number of samples 5668.
05-26 19:07:47 Source set CWRU_1 number of samples 9374.
05-26 19:07:47 Source set CWRU_3 number of samples 9492.
05-26 19:07:47 Training set number of samples 7586.
05-26 19:07:47 Validation set number of samples 1902.
05-26 19:09:03 -----Epoch 1/30-----
05-26 19:09:03 current lr: [0.01, 0.01]
05-26 19:10:13 Train-Loss Source Classifier: 1.6162
05-26 19:10:13 Train-Loss MMD: 0.1121
05-26 19:10:13 Train-Loss L1: 0.0392
05-26 19:10:13 Train-Acc Source Data: 0.4303
05-26 19:10:40 Val-Acc Target Data: 0.5286
05-26 19:10:41 The best model epoch 1, val-acc 0.5286
05-26 19:10:41 -----Epoch 2/30-----
05-26 19:10:41 current lr: [0.01, 0.01]
05-26 19:12:03 Train-Loss Source Classifier: 0.7171
05-26 19:12:03 Train-Loss MMD: 0.1185
05-26 19:12:03 Train-Loss L1: 0.0505
05-26 19:12:03 Train-Acc Source Data: 0.7358
05-26 19:12:28 Val-Acc Target Data: 0.7338
05-26 19:12:29 The best model epoch 2, val-acc 0.7338
05-26 19:12:29 -----Epoch 3/30-----
05-26 19:12:29 current lr: [0.01, 0.01]
05-26 19:14:19 Train-Loss Source Classifier: 0.4109
05-26 19:14:19 Train-Loss MMD: 0.1154
05-26 19:14:19 Train-Loss L1: 0.0427
05-26 19:14:19 Train-Acc Source Data: 0.8418
05-26 19:14:45 Val-Acc Target Data: 0.8330
05-26 19:14:46 The best model epoch 3, val-acc 0.8330
05-26 19:14:46 -----Epoch 4/30-----
05-26 19:14:46 current lr: [0.01, 0.01]
05-26 19:16:58 Train-Loss Source Classifier: 0.2729
05-26 19:16:58 Train-Loss MMD: 0.1134
05-26 19:16:58 Train-Loss L1: 0.0360
05-26 19:16:58 Train-Acc Source Data: 0.8995
05-26 19:17:24 Val-Acc Target Data: 0.9095
05-26 19:17:24 The best model epoch 4, val-acc 0.9095
05-26 19:17:24 -----Epoch 5/30-----
05-26 19:17:24 current lr: [0.01, 0.01]
05-26 19:19:10 Train-Loss Source Classifier: 0.1999
05-26 19:19:10 Train-Loss MMD: 0.1108
05-26 19:19:10 Train-Loss L1: 0.0286
05-26 19:19:10 Train-Acc Source Data: 0.9236
05-26 19:19:36 Val-Acc Target Data: 0.8847
05-26 19:19:37 The best model epoch 4, val-acc 0.9095
05-26 19:19:37 -----Epoch 6/30-----
05-26 19:19:37 current lr: [0.01, 0.01]
05-26 19:20:58 Train-Loss Source Classifier: 0.1521
05-26 19:20:58 Train-Loss MMD: 0.1066
05-26 19:20:58 Train-Loss L1: 0.0235
05-26 19:20:58 Train-Acc Source Data: 0.9367
05-26 19:21:24 Val-Acc Target Data: 0.9262
05-26 19:21:25 The best model epoch 6, val-acc 0.9262
05-26 19:21:25 -----Epoch 7/30-----
05-26 19:21:25 current lr: [0.01, 0.01]
05-26 19:23:10 Train-Loss Source Classifier: 0.1338
05-26 19:23:10 Train-Loss MMD: 0.1075
05-26 19:23:10 Train-Loss L1: 0.0208
05-26 19:23:10 Train-Acc Source Data: 0.9415
05-26 19:23:36 Val-Acc Target Data: 0.9537
05-26 19:23:37 The best model epoch 7, val-acc 0.9537
05-26 19:23:37 -----Epoch 8/30-----
05-26 19:23:37 current lr: [0.01, 0.01]
05-26 19:25:49 Train-Loss Source Classifier: 0.1076
05-26 19:25:49 Train-Loss MMD: 0.1047
05-26 19:25:49 Train-Loss L1: 0.0160
05-26 19:25:49 Train-Acc Source Data: 0.9582
05-26 19:26:15 Val-Acc Target Data: 0.8373
05-26 19:26:16 The best model epoch 7, val-acc 0.9537
05-26 19:26:16 -----Epoch 9/30-----
05-26 19:26:16 current lr: [0.01, 0.01]
05-26 19:28:03 Train-Loss Source Classifier: 0.0997
05-26 19:28:03 Train-Loss MMD: 0.1055
05-26 19:28:03 Train-Loss L1: 0.0164
05-26 19:28:03 Train-Acc Source Data: 0.9550
05-26 19:28:30 Val-Acc Target Data: 0.9359
05-26 19:28:31 The best model epoch 7, val-acc 0.9537
05-26 19:28:31 -----Epoch 10/30-----
05-26 19:28:31 current lr: [0.01, 0.01]
05-26 19:29:52 Train-Loss Source Classifier: 0.0803
05-26 19:29:52 Train-Loss MMD: 0.1045
05-26 19:29:52 Train-Loss L1: 0.0124
05-26 19:29:52 Train-Acc Source Data: 0.9631
05-26 19:30:17 Val-Acc Target Data: 0.9542
05-26 19:30:18 The best model epoch 10, val-acc 0.9542
05-26 19:30:18 -----Epoch 11/30-----
05-26 19:30:18 current lr: [0.002, 0.002]
05-26 19:31:39 Train-Loss Source Classifier: 0.0552
05-26 19:31:39 Train-Loss MMD: 0.1011
05-26 19:31:39 Train-Loss L1: 0.0095
05-26 19:31:39 Train-Acc Source Data: 0.9705
05-26 19:32:05 Val-Acc Target Data: 0.9774
05-26 19:32:06 The best model epoch 11, val-acc 0.9774
05-26 19:32:06 -----Epoch 12/30-----
05-26 19:32:06 current lr: [0.002, 0.002]
05-26 19:34:58 Train-Loss Source Classifier: 0.0468
05-26 19:34:58 Train-Loss MMD: 0.1023
05-26 19:34:58 Train-Loss L1: 0.0088
05-26 19:34:58 Train-Acc Source Data: 0.9742
05-26 19:35:24 Val-Acc Target Data: 0.9828
05-26 19:35:25 The best model epoch 12, val-acc 0.9828
05-26 19:35:25 -----Epoch 13/30-----
05-26 19:35:25 current lr: [0.002, 0.002]
05-26 19:36:47 Train-Loss Source Classifier: 0.0447
05-26 19:36:47 Train-Loss MMD: 0.0979
05-26 19:36:47 Train-Loss L1: 0.0079
05-26 19:36:47 Train-Acc Source Data: 0.9755
05-26 19:37:12 Val-Acc Target Data: 0.9817
05-26 19:37:13 The best model epoch 12, val-acc 0.9828
05-26 19:37:13 -----Epoch 14/30-----
05-26 19:37:13 current lr: [0.002, 0.002]
05-26 19:39:01 Train-Loss Source Classifier: 0.0444
05-26 19:39:01 Train-Loss MMD: 0.1027
05-26 19:39:01 Train-Loss L1: 0.0076
05-26 19:39:01 Train-Acc Source Data: 0.9756
05-26 19:39:27 Val-Acc Target Data: 0.9806
05-26 19:39:28 The best model epoch 12, val-acc 0.9828
05-26 19:39:28 -----Epoch 15/30-----
05-26 19:39:28 current lr: [0.002, 0.002]
05-26 19:41:15 Train-Loss Source Classifier: 0.0456
05-26 19:41:15 Train-Loss MMD: 0.0972
05-26 19:41:15 Train-Loss L1: 0.0076
05-26 19:41:15 Train-Acc Source Data: 0.9762
05-26 19:41:40 Val-Acc Target Data: 0.9828
05-26 19:41:41 The best model epoch 15, val-acc 0.9828
05-26 19:41:41 -----Epoch 16/30-----
05-26 19:41:41 current lr: [0.002, 0.002]
05-26 19:43:45 Train-Loss Source Classifier: 0.0441
05-26 19:43:45 Train-Loss MMD: 0.0982
05-26 19:43:45 Train-Loss L1: 0.0075
05-26 19:43:45 Train-Acc Source Data: 0.9751
05-26 19:44:11 Val-Acc Target Data: 0.9838
05-26 19:44:12 The best model epoch 16, val-acc 0.9838
05-26 19:44:12 -----Epoch 17/30-----
05-26 19:44:12 current lr: [0.002, 0.002]
05-26 19:45:33 Train-Loss Source Classifier: 0.0415
05-26 19:45:33 Train-Loss MMD: 0.1002
05-26 19:45:33 Train-Loss L1: 0.0070
05-26 19:45:33 Train-Acc Source Data: 0.9780
05-26 19:45:59 Val-Acc Target Data: 0.9763
05-26 19:45:59 The best model epoch 16, val-acc 0.9838
05-26 19:45:59 -----Epoch 18/30-----
05-26 19:45:59 current lr: [0.002, 0.002]
05-26 19:47:45 Train-Loss Source Classifier: 0.0434
05-26 19:47:45 Train-Loss MMD: 0.0991
05-26 19:47:45 Train-Loss L1: 0.0073
05-26 19:47:45 Train-Acc Source Data: 0.9751
05-26 19:48:12 Val-Acc Target Data: 0.9838
05-26 19:48:13 The best model epoch 18, val-acc 0.9838
05-26 19:48:13 -----Epoch 19/30-----
05-26 19:48:13 current lr: [0.002, 0.002]
05-26 19:50:28 Train-Loss Source Classifier: 0.0429
05-26 19:50:28 Train-Loss MMD: 0.0991
05-26 19:50:28 Train-Loss L1: 0.0067
05-26 19:50:28 Train-Acc Source Data: 0.9764
05-26 19:50:55 Val-Acc Target Data: 0.9833
05-26 19:50:56 The best model epoch 18, val-acc 0.9838
05-26 19:50:56 -----Epoch 20/30-----
05-26 19:50:56 current lr: [0.002, 0.002]
05-26 19:52:41 Train-Loss Source Classifier: 0.0427
05-26 19:52:41 Train-Loss MMD: 0.0994
05-26 19:52:41 Train-Loss L1: 0.0064
05-26 19:52:41 Train-Acc Source Data: 0.9760
05-26 19:53:08 Val-Acc Target Data: 0.9860
05-26 19:53:09 The best model epoch 20, val-acc 0.9860
05-26 19:53:09 -----Epoch 21/30-----
05-26 19:53:09 current lr: [0.0004, 0.0004]
05-26 19:54:31 Train-Loss Source Classifier: 0.0380
05-26 19:54:31 Train-Loss MMD: 0.0974
05-26 19:54:31 Train-Loss L1: 0.0063
05-26 19:54:31 Train-Acc Source Data: 0.9785
05-26 19:54:57 Val-Acc Target Data: 0.9844
05-26 19:54:58 The best model epoch 20, val-acc 0.9860
05-26 19:54:58 -----Epoch 22/30-----
05-26 19:54:58 current lr: [0.0004, 0.0004]
05-26 19:56:19 Train-Loss Source Classifier: 0.0413
05-26 19:56:19 Train-Loss MMD: 0.0986
05-26 19:56:19 Train-Loss L1: 0.0062
05-26 19:56:19 Train-Acc Source Data: 0.9764
05-26 19:56:44 Val-Acc Target Data: 0.9844
05-26 19:56:45 The best model epoch 20, val-acc 0.9860
05-26 19:56:45 -----Epoch 23/30-----
05-26 19:56:45 current lr: [0.0004, 0.0004]
05-26 19:59:24 Train-Loss Source Classifier: 0.0400
05-26 19:59:24 Train-Loss MMD: 0.0963
05-26 19:59:24 Train-Loss L1: 0.0061
05-26 19:59:24 Train-Acc Source Data: 0.9768
05-26 19:59:51 Val-Acc Target Data: 0.9860
05-26 19:59:52 The best model epoch 23, val-acc 0.9860
05-26 19:59:52 -----Epoch 24/30-----
05-26 19:59:52 current lr: [0.0004, 0.0004]
05-26 20:01:13 Train-Loss Source Classifier: 0.0392
05-26 20:01:13 Train-Loss MMD: 0.0976
05-26 20:01:13 Train-Loss L1: 0.0061
05-26 20:01:13 Train-Acc Source Data: 0.9782
05-26 20:01:37 Val-Acc Target Data: 0.9855
05-26 20:01:38 The best model epoch 23, val-acc 0.9860
05-26 20:01:38 -----Epoch 25/30-----
05-26 20:01:38 current lr: [0.0004, 0.0004]
05-26 20:03:26 Train-Loss Source Classifier: 0.0397
05-26 20:03:26 Train-Loss MMD: 0.0979
05-26 20:03:26 Train-Loss L1: 0.0062
05-26 20:03:26 Train-Acc Source Data: 0.9771
05-26 20:03:51 Val-Acc Target Data: 0.9860
05-26 20:03:52 The best model epoch 25, val-acc 0.9860
05-26 20:03:52 -----Epoch 26/30-----
05-26 20:03:52 current lr: [0.0004, 0.0004]
05-26 20:05:12 Train-Loss Source Classifier: 0.0407
05-26 20:05:12 Train-Loss MMD: 0.0958
05-26 20:05:12 Train-Loss L1: 0.0059
05-26 20:05:12 Train-Acc Source Data: 0.9768
05-26 20:05:38 Val-Acc Target Data: 0.9855
05-26 20:05:39 The best model epoch 25, val-acc 0.9860
05-26 20:05:39 -----Epoch 27/30-----
05-26 20:05:39 current lr: [0.0004, 0.0004]
05-26 20:08:19 Train-Loss Source Classifier: 0.0378
05-26 20:08:19 Train-Loss MMD: 0.0959
05-26 20:08:19 Train-Loss L1: 0.0059
05-26 20:08:19 Train-Acc Source Data: 0.9778
05-26 20:08:46 Val-Acc Target Data: 0.9844
05-26 20:08:46 The best model epoch 25, val-acc 0.9860
05-26 20:08:46 -----Epoch 28/30-----
05-26 20:08:46 current lr: [0.0004, 0.0004]
05-26 20:10:07 Train-Loss Source Classifier: 0.0378
05-26 20:10:07 Train-Loss MMD: 0.1003
05-26 20:10:07 Train-Loss L1: 0.0057
05-26 20:10:07 Train-Acc Source Data: 0.9795
05-26 20:10:32 Val-Acc Target Data: 0.9849
05-26 20:10:32 The best model epoch 25, val-acc 0.9860
05-26 20:10:32 -----Epoch 29/30-----
05-26 20:10:32 current lr: [0.0004, 0.0004]
05-26 20:12:17 Train-Loss Source Classifier: 0.0387
05-26 20:12:17 Train-Loss MMD: 0.0964
05-26 20:12:17 Train-Loss L1: 0.0060
05-26 20:12:17 Train-Acc Source Data: 0.9779
05-26 20:12:43 Val-Acc Target Data: 0.9833
05-26 20:12:44 The best model epoch 25, val-acc 0.9860
05-26 20:12:44 -----Epoch 30/30-----
05-26 20:12:44 current lr: [0.0004, 0.0004]
05-26 20:14:34 Train-Loss Source Classifier: 0.0409
05-26 20:14:34 Train-Loss MMD: 0.0954
05-26 20:14:34 Train-Loss L1: 0.0058
05-26 20:14:34 Train-Acc Source Data: 0.9774
05-26 20:15:00 Val-Acc Target Data: 0.9849
05-26 20:15:01 The best model epoch 25, val-acc 0.9860
05-26 20:15:01 Model saved to ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1CWRU_3]To[CWRU_2]_0526-190744.pth
