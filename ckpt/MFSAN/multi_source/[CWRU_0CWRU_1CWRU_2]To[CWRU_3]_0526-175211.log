05-26 17:52:11 model_name: MFSAN
05-26 17:52:11 source: CWRU_0,CWRU_1,CWRU_2
05-26 17:52:11 target: CWRU_3
05-26 17:52:11 data_dir: ./datasets
05-26 17:52:11 train_mode: multi_source
05-26 17:52:11 cuda_device: 0
05-26 17:52:11 save_dir: ./ckpt
05-26 17:52:11 max_epoch: 30
05-26 17:52:11 batch_size: 64
05-26 17:52:11 num_workers: 4
05-26 17:52:11 signal_size: 1024
05-26 17:52:11 random_state: 1
05-26 17:52:11 normlizetype: -1-1
05-26 17:52:11 opt: sgd
05-26 17:52:11 lr: 0.01
05-26 17:52:11 momentum: 0.9
05-26 17:52:11 betas: (0.9, 0.999)
05-26 17:52:11 weight_decay: 0.0005
05-26 17:52:11 lr_scheduler: stepLR
05-26 17:52:11 gamma: 0.2
05-26 17:52:11 steps: 10
05-26 17:52:11 tradeoff: ['exp', 'exp', 'exp']
05-26 17:52:11 dropout: 0.0
05-26 17:52:11 save: True
05-26 17:52:11 load_path: 
05-26 17:52:11 save_path: ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1CWRU_2]To[CWRU_3]_0526-175211
05-26 17:52:11 Detect 10 classes: ['B007', 'B014', 'B021', 'IR007', 'IR014', 'IR021', 'Normal', 'OR007', 'OR014', 'OR021']
05-26 17:52:11 using 1 / 1 gpus
05-26 17:52:16 Source set CWRU_0 number of samples 5668.
05-26 17:52:16 Source set CWRU_1 number of samples 9374.
05-26 17:52:16 Source set CWRU_2 number of samples 9488.
05-26 17:52:16 Training set number of samples 7590.
05-26 17:52:16 Validation set number of samples 1902.
05-26 17:53:41 -----Epoch 1/30-----
05-26 17:53:41 current lr: [0.01, 0.01]
05-26 17:54:34 Train-Loss Source Classifier: 1.6069
05-26 17:54:34 Train-Loss MMD: 0.1140
05-26 17:54:34 Train-Loss L1: 0.0391
05-26 17:54:34 Train-Acc Source Data: 0.4306
05-26 17:54:59 Val-Acc Target Data: 0.5819
05-26 17:55:00 The best model epoch 1, val-acc 0.5819
05-26 17:55:00 -----Epoch 2/30-----
05-26 17:55:00 current lr: [0.01, 0.01]
05-26 17:56:18 Train-Loss Source Classifier: 0.7196
05-26 17:56:18 Train-Loss MMD: 0.1248
05-26 17:56:18 Train-Loss L1: 0.0530
05-26 17:56:18 Train-Acc Source Data: 0.7300
05-26 17:56:43 Val-Acc Target Data: 0.6880
05-26 17:56:44 The best model epoch 2, val-acc 0.6880
05-26 17:56:44 -----Epoch 3/30-----
05-26 17:56:44 current lr: [0.01, 0.01]
05-26 17:59:07 Train-Loss Source Classifier: 0.4183
05-26 17:59:07 Train-Loss MMD: 0.1199
05-26 17:59:07 Train-Loss L1: 0.0455
05-26 17:59:07 Train-Acc Source Data: 0.8394
05-26 17:59:48 Val-Acc Target Data: 0.8109
05-26 17:59:49 The best model epoch 3, val-acc 0.8109
05-26 17:59:49 -----Epoch 4/30-----
05-26 17:59:49 current lr: [0.01, 0.01]
05-26 18:02:38 Train-Loss Source Classifier: 0.2586
05-26 18:02:38 Train-Loss MMD: 0.1149
05-26 18:02:38 Train-Loss L1: 0.0381
05-26 18:02:38 Train-Acc Source Data: 0.9020
05-26 18:03:35 Val-Acc Target Data: 0.7877
05-26 18:03:36 The best model epoch 3, val-acc 0.8109
05-26 18:03:36 -----Epoch 5/30-----
05-26 18:03:36 current lr: [0.01, 0.01]
05-26 18:06:00 Train-Loss Source Classifier: 0.1809
05-26 18:06:00 Train-Loss MMD: 0.1126
05-26 18:06:00 Train-Loss L1: 0.0310
05-26 18:06:00 Train-Acc Source Data: 0.9281
05-26 18:06:34 Val-Acc Target Data: 0.8863
05-26 18:06:35 The best model epoch 5, val-acc 0.8863
05-26 18:06:35 -----Epoch 6/30-----
05-26 18:06:35 current lr: [0.01, 0.01]
05-26 18:08:00 Train-Loss Source Classifier: 0.1425
05-26 18:08:00 Train-Loss MMD: 0.1122
05-26 18:08:00 Train-Loss L1: 0.0290
05-26 18:08:00 Train-Acc Source Data: 0.9392
05-26 18:08:25 Val-Acc Target Data: 0.8572
05-26 18:08:26 The best model epoch 5, val-acc 0.8863
05-26 18:08:26 -----Epoch 7/30-----
05-26 18:08:26 current lr: [0.01, 0.01]
05-26 18:10:12 Train-Loss Source Classifier: 0.1162
05-26 18:10:12 Train-Loss MMD: 0.1087
05-26 18:10:12 Train-Loss L1: 0.0236
05-26 18:10:12 Train-Acc Source Data: 0.9492
05-26 18:10:38 Val-Acc Target Data: 0.9122
05-26 18:10:38 The best model epoch 7, val-acc 0.9122
05-26 18:10:38 -----Epoch 8/30-----
05-26 18:10:38 current lr: [0.01, 0.01]
05-26 18:12:56 Train-Loss Source Classifier: 0.1013
05-26 18:12:56 Train-Loss MMD: 0.1082
05-26 18:12:56 Train-Loss L1: 0.0220
05-26 18:12:56 Train-Acc Source Data: 0.9562
05-26 18:13:22 Val-Acc Target Data: 0.9052
05-26 18:13:23 The best model epoch 7, val-acc 0.9122
05-26 18:13:23 -----Epoch 9/30-----
05-26 18:13:23 current lr: [0.01, 0.01]
05-26 18:15:11 Train-Loss Source Classifier: 0.1018
05-26 18:15:11 Train-Loss MMD: 0.1065
05-26 18:15:11 Train-Loss L1: 0.0199
05-26 18:15:11 Train-Acc Source Data: 0.9548
05-26 18:15:36 Val-Acc Target Data: 0.9052
05-26 18:15:37 The best model epoch 7, val-acc 0.9122
05-26 18:15:37 -----Epoch 10/30-----
05-26 18:15:37 current lr: [0.01, 0.01]
05-26 18:17:02 Train-Loss Source Classifier: 0.0744
05-26 18:17:02 Train-Loss MMD: 0.1055
05-26 18:17:02 Train-Loss L1: 0.0151
05-26 18:17:02 Train-Acc Source Data: 0.9633
05-26 18:17:29 Val-Acc Target Data: 0.9305
05-26 18:17:30 The best model epoch 10, val-acc 0.9305
05-26 18:17:30 -----Epoch 11/30-----
05-26 18:17:30 current lr: [0.002, 0.002]
05-26 18:18:54 Train-Loss Source Classifier: 0.0524
05-26 18:18:54 Train-Loss MMD: 0.1052
05-26 18:18:54 Train-Loss L1: 0.0106
05-26 18:18:54 Train-Acc Source Data: 0.9715
05-26 18:19:20 Val-Acc Target Data: 0.9413
05-26 18:19:21 The best model epoch 11, val-acc 0.9413
05-26 18:19:21 -----Epoch 12/30-----
05-26 18:19:21 current lr: [0.002, 0.002]
05-26 18:22:29 Train-Loss Source Classifier: 0.0447
05-26 18:22:29 Train-Loss MMD: 0.1039
05-26 18:22:29 Train-Loss L1: 0.0095
05-26 18:22:29 Train-Acc Source Data: 0.9756
05-26 18:23:18 Val-Acc Target Data: 0.9418
05-26 18:23:19 The best model epoch 12, val-acc 0.9418
05-26 18:23:19 -----Epoch 13/30-----
05-26 18:23:19 current lr: [0.002, 0.002]
05-26 18:25:05 Train-Loss Source Classifier: 0.0435
05-26 18:25:05 Train-Loss MMD: 0.1012
05-26 18:25:05 Train-Loss L1: 0.0092
05-26 18:25:05 Train-Acc Source Data: 0.9756
05-26 18:25:31 Val-Acc Target Data: 0.9418
05-26 18:25:32 The best model epoch 13, val-acc 0.9418
05-26 18:25:32 -----Epoch 14/30-----
05-26 18:25:32 current lr: [0.002, 0.002]
05-26 18:27:22 Train-Loss Source Classifier: 0.0446
05-26 18:27:22 Train-Loss MMD: 0.1042
05-26 18:27:22 Train-Loss L1: 0.0085
05-26 18:27:22 Train-Acc Source Data: 0.9752
05-26 18:27:50 Val-Acc Target Data: 0.9440
05-26 18:27:51 The best model epoch 14, val-acc 0.9440
05-26 18:27:51 -----Epoch 15/30-----
05-26 18:27:51 current lr: [0.002, 0.002]
05-26 18:30:16 Train-Loss Source Classifier: 0.0416
05-26 18:30:16 Train-Loss MMD: 0.1023
05-26 18:30:16 Train-Loss L1: 0.0082
05-26 18:30:16 Train-Acc Source Data: 0.9763
05-26 18:30:37 Val-Acc Target Data: 0.9483
05-26 18:30:38 The best model epoch 15, val-acc 0.9483
05-26 18:30:38 -----Epoch 16/30-----
05-26 18:30:38 current lr: [0.002, 0.002]
05-26 18:33:18 Train-Loss Source Classifier: 0.0446
05-26 18:33:18 Train-Loss MMD: 0.1022
05-26 18:33:18 Train-Loss L1: 0.0083
05-26 18:33:18 Train-Acc Source Data: 0.9767
05-26 18:33:55 Val-Acc Target Data: 0.9380
05-26 18:33:56 The best model epoch 15, val-acc 0.9483
05-26 18:33:56 -----Epoch 17/30-----
05-26 18:33:56 current lr: [0.002, 0.002]
05-26 18:35:46 Train-Loss Source Classifier: 0.0406
05-26 18:35:46 Train-Loss MMD: 0.1021
05-26 18:35:46 Train-Loss L1: 0.0079
05-26 18:35:46 Train-Acc Source Data: 0.9793
05-26 18:36:31 Val-Acc Target Data: 0.9423
05-26 18:36:32 The best model epoch 15, val-acc 0.9483
05-26 18:36:32 -----Epoch 18/30-----
05-26 18:36:32 current lr: [0.002, 0.002]
05-26 18:38:32 Train-Loss Source Classifier: 0.0435
05-26 18:38:32 Train-Loss MMD: 0.0995
05-26 18:38:32 Train-Loss L1: 0.0077
05-26 18:38:32 Train-Acc Source Data: 0.9733
05-26 18:38:58 Val-Acc Target Data: 0.9440
05-26 18:38:59 The best model epoch 15, val-acc 0.9483
05-26 18:38:59 -----Epoch 19/30-----
05-26 18:38:59 current lr: [0.002, 0.002]
05-26 18:41:12 Train-Loss Source Classifier: 0.0410
05-26 18:41:12 Train-Loss MMD: 0.1025
05-26 18:41:12 Train-Loss L1: 0.0076
05-26 18:41:12 Train-Acc Source Data: 0.9774
05-26 18:41:38 Val-Acc Target Data: 0.9477
05-26 18:41:39 The best model epoch 15, val-acc 0.9483
05-26 18:41:39 -----Epoch 20/30-----
05-26 18:41:39 current lr: [0.002, 0.002]
05-26 18:43:25 Train-Loss Source Classifier: 0.0399
05-26 18:43:25 Train-Loss MMD: 0.1028
05-26 18:43:25 Train-Loss L1: 0.0072
05-26 18:43:25 Train-Acc Source Data: 0.9762
05-26 18:43:51 Val-Acc Target Data: 0.9499
05-26 18:43:52 The best model epoch 20, val-acc 0.9499
05-26 18:43:52 -----Epoch 21/30-----
05-26 18:43:52 current lr: [0.0004, 0.0004]
05-26 18:45:13 Train-Loss Source Classifier: 0.0381
05-26 18:45:13 Train-Loss MMD: 0.1008
05-26 18:45:13 Train-Loss L1: 0.0070
05-26 18:45:13 Train-Acc Source Data: 0.9795
05-26 18:45:38 Val-Acc Target Data: 0.9488
05-26 18:45:39 The best model epoch 20, val-acc 0.9499
05-26 18:45:39 -----Epoch 22/30-----
05-26 18:45:39 current lr: [0.0004, 0.0004]
05-26 18:47:00 Train-Loss Source Classifier: 0.0400
05-26 18:47:00 Train-Loss MMD: 0.1011
05-26 18:47:00 Train-Loss L1: 0.0068
05-26 18:47:00 Train-Acc Source Data: 0.9754
05-26 18:47:26 Val-Acc Target Data: 0.9483
05-26 18:47:27 The best model epoch 20, val-acc 0.9499
05-26 18:47:27 -----Epoch 23/30-----
05-26 18:47:27 current lr: [0.0004, 0.0004]
05-26 18:50:11 Train-Loss Source Classifier: 0.0396
05-26 18:50:11 Train-Loss MMD: 0.1015
05-26 18:50:11 Train-Loss L1: 0.0068
05-26 18:50:11 Train-Acc Source Data: 0.9774
05-26 18:50:38 Val-Acc Target Data: 0.9467
05-26 18:50:39 The best model epoch 20, val-acc 0.9499
05-26 18:50:39 -----Epoch 24/30-----
05-26 18:50:39 current lr: [0.0004, 0.0004]
05-26 18:52:01 Train-Loss Source Classifier: 0.0376
05-26 18:52:01 Train-Loss MMD: 0.0972
05-26 18:52:01 Train-Loss L1: 0.0067
05-26 18:52:01 Train-Acc Source Data: 0.9789
05-26 18:52:28 Val-Acc Target Data: 0.9467
05-26 18:52:29 The best model epoch 20, val-acc 0.9499
05-26 18:52:29 -----Epoch 25/30-----
05-26 18:52:29 current lr: [0.0004, 0.0004]
05-26 18:54:17 Train-Loss Source Classifier: 0.0390
05-26 18:54:17 Train-Loss MMD: 0.0979
05-26 18:54:17 Train-Loss L1: 0.0069
05-26 18:54:17 Train-Acc Source Data: 0.9768
05-26 18:54:42 Val-Acc Target Data: 0.9472
05-26 18:54:43 The best model epoch 20, val-acc 0.9499
05-26 18:54:43 -----Epoch 26/30-----
05-26 18:54:43 current lr: [0.0004, 0.0004]
05-26 18:56:04 Train-Loss Source Classifier: 0.0399
05-26 18:56:04 Train-Loss MMD: 0.1003
05-26 18:56:04 Train-Loss L1: 0.0065
05-26 18:56:04 Train-Acc Source Data: 0.9785
05-26 18:56:29 Val-Acc Target Data: 0.9472
05-26 18:56:30 The best model epoch 20, val-acc 0.9499
05-26 18:56:30 -----Epoch 27/30-----
05-26 18:56:30 current lr: [0.0004, 0.0004]
05-26 18:59:10 Train-Loss Source Classifier: 0.0364
05-26 18:59:10 Train-Loss MMD: 0.0987
05-26 18:59:10 Train-Loss L1: 0.0067
05-26 18:59:10 Train-Acc Source Data: 0.9789
05-26 18:59:36 Val-Acc Target Data: 0.9504
05-26 18:59:37 The best model epoch 27, val-acc 0.9504
05-26 18:59:37 -----Epoch 28/30-----
05-26 18:59:37 current lr: [0.0004, 0.0004]
05-26 19:00:58 Train-Loss Source Classifier: 0.0388
05-26 19:00:58 Train-Loss MMD: 0.1017
05-26 19:00:58 Train-Loss L1: 0.0067
05-26 19:00:58 Train-Acc Source Data: 0.9779
05-26 19:01:24 Val-Acc Target Data: 0.9483
05-26 19:01:25 The best model epoch 27, val-acc 0.9504
05-26 19:01:25 -----Epoch 29/30-----
05-26 19:01:25 current lr: [0.0004, 0.0004]
05-26 19:03:11 Train-Loss Source Classifier: 0.0382
05-26 19:03:11 Train-Loss MMD: 0.0972
05-26 19:03:11 Train-Loss L1: 0.0066
05-26 19:03:11 Train-Acc Source Data: 0.9784
05-26 19:03:38 Val-Acc Target Data: 0.9488
05-26 19:03:39 The best model epoch 27, val-acc 0.9504
05-26 19:03:39 -----Epoch 30/30-----
05-26 19:03:39 current lr: [0.0004, 0.0004]
05-26 19:05:26 Train-Loss Source Classifier: 0.0392
05-26 19:05:26 Train-Loss MMD: 0.0980
05-26 19:05:26 Train-Loss L1: 0.0066
05-26 19:05:26 Train-Acc Source Data: 0.9788
05-26 19:05:52 Val-Acc Target Data: 0.9488
05-26 19:05:53 The best model epoch 27, val-acc 0.9504
05-26 19:05:53 Model saved to ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1CWRU_2]To[CWRU_3]_0526-175211.pth
