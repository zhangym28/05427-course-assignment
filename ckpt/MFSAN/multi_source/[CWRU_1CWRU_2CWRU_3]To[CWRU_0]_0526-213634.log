05-26 21:36:34 model_name: MFSAN
05-26 21:36:34 source: CWRU_1,CWRU_2,CWRU_3
05-26 21:36:34 target: CWRU_0
05-26 21:36:34 data_dir: ./datasets
05-26 21:36:34 train_mode: multi_source
05-26 21:36:34 cuda_device: 0
05-26 21:36:34 save_dir: ./ckpt
05-26 21:36:34 max_epoch: 30
05-26 21:36:34 batch_size: 64
05-26 21:36:34 num_workers: 4
05-26 21:36:34 signal_size: 1024
05-26 21:36:34 random_state: 1
05-26 21:36:34 normlizetype: -1-1
05-26 21:36:34 opt: sgd
05-26 21:36:34 lr: 0.01
05-26 21:36:34 momentum: 0.9
05-26 21:36:34 betas: (0.9, 0.999)
05-26 21:36:34 weight_decay: 0.0005
05-26 21:36:34 lr_scheduler: stepLR
05-26 21:36:34 gamma: 0.2
05-26 21:36:34 steps: 10
05-26 21:36:34 tradeoff: ['exp', 'exp', 'exp']
05-26 21:36:34 dropout: 0.0
05-26 21:36:34 save: True
05-26 21:36:34 load_path: 
05-26 21:36:34 save_path: ./ckpt\MFSAN\multi_source\[CWRU_1CWRU_2CWRU_3]To[CWRU_0]_0526-213634
05-26 21:36:34 Detect 10 classes: ['B007', 'B014', 'B021', 'IR007', 'IR014', 'IR021', 'Normal', 'OR007', 'OR014', 'OR021']
05-26 21:36:34 using 1 / 1 gpus
05-26 21:36:36 Source set CWRU_1 number of samples 9374.
05-26 21:36:36 Source set CWRU_2 number of samples 9488.
05-26 21:36:36 Source set CWRU_3 number of samples 9492.
05-26 21:36:37 Training set number of samples 4532.
05-26 21:36:37 Validation set number of samples 1136.
05-26 21:37:54 -----Epoch 1/30-----
05-26 21:37:54 current lr: [0.01, 0.01]
05-26 21:39:23 Train-Loss Source Classifier: 1.8842
05-26 21:39:23 Train-Loss MMD: 0.1557
05-26 21:39:23 Train-Loss L1: 0.0331
05-26 21:39:23 Train-Acc Source Data: 0.3348
05-26 21:39:55 Val-Acc Target Data: 0.4540
05-26 21:39:56 The best model epoch 1, val-acc 0.4540
05-26 21:39:56 -----Epoch 2/30-----
05-26 21:39:56 current lr: [0.01, 0.01]
05-26 21:41:18 Train-Loss Source Classifier: 1.0253
05-26 21:41:18 Train-Loss MMD: 0.1415
05-26 21:41:18 Train-Loss L1: 0.0517
05-26 21:41:18 Train-Acc Source Data: 0.6266
05-26 21:41:44 Val-Acc Target Data: 0.5156
05-26 21:41:45 The best model epoch 2, val-acc 0.5156
05-26 21:41:45 -----Epoch 3/30-----
05-26 21:41:45 current lr: [0.01, 0.01]
05-26 21:42:44 Train-Loss Source Classifier: 0.6163
05-26 21:42:44 Train-Loss MMD: 0.1412
05-26 21:42:44 Train-Loss L1: 0.0479
05-26 21:42:44 Train-Acc Source Data: 0.7703
05-26 21:43:10 Val-Acc Target Data: 0.4954
05-26 21:43:11 The best model epoch 2, val-acc 0.5156
05-26 21:43:11 -----Epoch 4/30-----
05-26 21:43:11 current lr: [0.01, 0.01]
05-26 21:44:11 Train-Loss Source Classifier: 0.4475
05-26 21:44:11 Train-Loss MMD: 0.1314
05-26 21:44:11 Train-Loss L1: 0.0396
05-26 21:44:11 Train-Acc Source Data: 0.8342
05-26 21:44:36 Val-Acc Target Data: 0.6296
05-26 21:44:37 The best model epoch 4, val-acc 0.6296
05-26 21:44:37 -----Epoch 5/30-----
05-26 21:44:37 current lr: [0.01, 0.01]
05-26 21:45:37 Train-Loss Source Classifier: 0.3696
05-26 21:45:37 Train-Loss MMD: 0.1234
05-26 21:45:37 Train-Loss L1: 0.0358
05-26 21:45:37 Train-Acc Source Data: 0.8618
05-26 21:46:03 Val-Acc Target Data: 0.7031
05-26 21:46:04 The best model epoch 5, val-acc 0.7031
05-26 21:46:04 -----Epoch 6/30-----
05-26 21:46:04 current lr: [0.01, 0.01]
05-26 21:47:03 Train-Loss Source Classifier: 0.2299
05-26 21:47:03 Train-Loss MMD: 0.1221
05-26 21:47:03 Train-Loss L1: 0.0285
05-26 21:47:03 Train-Acc Source Data: 0.9199
05-26 21:47:31 Val-Acc Target Data: 0.6581
05-26 21:47:32 The best model epoch 5, val-acc 0.7031
05-26 21:47:32 -----Epoch 7/30-----
05-26 21:47:32 current lr: [0.01, 0.01]
05-26 21:49:55 Train-Loss Source Classifier: 0.1786
05-26 21:49:55 Train-Loss MMD: 0.1208
05-26 21:49:55 Train-Loss L1: 0.0260
05-26 21:49:55 Train-Acc Source Data: 0.9395
05-26 21:50:21 Val-Acc Target Data: 0.7353
05-26 21:50:22 The best model epoch 7, val-acc 0.7353
05-26 21:50:22 -----Epoch 8/30-----
05-26 21:50:22 current lr: [0.01, 0.01]
05-26 21:51:24 Train-Loss Source Classifier: 0.1980
05-26 21:51:24 Train-Loss MMD: 0.1172
05-26 21:51:24 Train-Loss L1: 0.0272
05-26 21:51:24 Train-Acc Source Data: 0.9335
05-26 21:51:50 Val-Acc Target Data: 0.6939
05-26 21:51:51 The best model epoch 7, val-acc 0.7353
05-26 21:51:51 -----Epoch 9/30-----
05-26 21:51:51 current lr: [0.01, 0.01]
05-26 21:52:50 Train-Loss Source Classifier: 0.1580
05-26 21:52:50 Train-Loss MMD: 0.1122
05-26 21:52:50 Train-Loss L1: 0.0209
05-26 21:52:50 Train-Acc Source Data: 0.9458
05-26 21:53:15 Val-Acc Target Data: 0.7537
05-26 21:53:16 The best model epoch 9, val-acc 0.7537
05-26 21:53:16 -----Epoch 10/30-----
05-26 21:53:16 current lr: [0.01, 0.01]
05-26 21:54:15 Train-Loss Source Classifier: 0.1218
05-26 21:54:15 Train-Loss MMD: 0.1112
05-26 21:54:15 Train-Loss L1: 0.0171
05-26 21:54:15 Train-Acc Source Data: 0.9556
05-26 21:54:41 Val-Acc Target Data: 0.7417
05-26 21:54:42 The best model epoch 9, val-acc 0.7537
05-26 21:54:42 -----Epoch 11/30-----
05-26 21:54:42 current lr: [0.002, 0.002]
05-26 21:55:42 Train-Loss Source Classifier: 0.0768
05-26 21:55:42 Train-Loss MMD: 0.1067
05-26 21:55:42 Train-Loss L1: 0.0113
05-26 21:55:42 Train-Acc Source Data: 0.9768
05-26 21:56:07 Val-Acc Target Data: 0.8024
05-26 21:56:08 The best model epoch 11, val-acc 0.8024
05-26 21:56:08 -----Epoch 12/30-----
05-26 21:56:08 current lr: [0.002, 0.002]
05-26 21:57:07 Train-Loss Source Classifier: 0.0564
05-26 21:57:07 Train-Loss MMD: 0.1126
05-26 21:57:07 Train-Loss L1: 0.0089
05-26 21:57:07 Train-Acc Source Data: 0.9837
05-26 21:57:32 Val-Acc Target Data: 0.7996
05-26 21:57:33 The best model epoch 11, val-acc 0.8024
05-26 21:57:33 -----Epoch 13/30-----
05-26 21:57:33 current lr: [0.002, 0.002]
05-26 21:59:57 Train-Loss Source Classifier: 0.0549
05-26 21:59:57 Train-Loss MMD: 0.1068
05-26 21:59:57 Train-Loss L1: 0.0085
05-26 21:59:57 Train-Acc Source Data: 0.9826
05-26 22:00:21 Val-Acc Target Data: 0.7978
05-26 22:00:22 The best model epoch 11, val-acc 0.8024
05-26 22:00:22 -----Epoch 14/30-----
05-26 22:00:22 current lr: [0.002, 0.002]
05-26 22:01:38 Train-Loss Source Classifier: 0.0501
05-26 22:01:38 Train-Loss MMD: 0.1064
05-26 22:01:38 Train-Loss L1: 0.0079
05-26 22:01:38 Train-Acc Source Data: 0.9842
05-26 22:02:03 Val-Acc Target Data: 0.8171
05-26 22:02:04 The best model epoch 14, val-acc 0.8171
05-26 22:02:04 -----Epoch 15/30-----
05-26 22:02:04 current lr: [0.002, 0.002]
05-26 22:03:06 Train-Loss Source Classifier: 0.0416
05-26 22:03:06 Train-Loss MMD: 0.1029
05-26 22:03:06 Train-Loss L1: 0.0075
05-26 22:03:06 Train-Acc Source Data: 0.9884
05-26 22:03:32 Val-Acc Target Data: 0.8134
05-26 22:03:33 The best model epoch 14, val-acc 0.8171
05-26 22:03:33 -----Epoch 16/30-----
05-26 22:03:33 current lr: [0.002, 0.002]
05-26 22:04:33 Train-Loss Source Classifier: 0.0409
05-26 22:04:33 Train-Loss MMD: 0.1049
05-26 22:04:33 Train-Loss L1: 0.0071
05-26 22:04:33 Train-Acc Source Data: 0.9866
05-26 22:04:59 Val-Acc Target Data: 0.8024
05-26 22:05:00 The best model epoch 14, val-acc 0.8171
05-26 22:05:00 -----Epoch 17/30-----
05-26 22:05:00 current lr: [0.002, 0.002]
05-26 22:06:00 Train-Loss Source Classifier: 0.0385
05-26 22:06:00 Train-Loss MMD: 0.1044
05-26 22:06:00 Train-Loss L1: 0.0068
05-26 22:06:00 Train-Acc Source Data: 0.9897
05-26 22:06:24 Val-Acc Target Data: 0.8244
05-26 22:06:25 The best model epoch 17, val-acc 0.8244
05-26 22:06:25 -----Epoch 18/30-----
05-26 22:06:25 current lr: [0.002, 0.002]
05-26 22:07:25 Train-Loss Source Classifier: 0.0374
05-26 22:07:25 Train-Loss MMD: 0.1059
05-26 22:07:25 Train-Loss L1: 0.0064
05-26 22:07:25 Train-Acc Source Data: 0.9904
05-26 22:07:51 Val-Acc Target Data: 0.8134
05-26 22:07:52 The best model epoch 17, val-acc 0.8244
05-26 22:07:52 -----Epoch 19/30-----
05-26 22:07:52 current lr: [0.002, 0.002]
05-26 22:09:21 Train-Loss Source Classifier: 0.0388
05-26 22:09:21 Train-Loss MMD: 0.1052
05-26 22:09:21 Train-Loss L1: 0.0062
05-26 22:09:21 Train-Acc Source Data: 0.9868
05-26 22:09:49 Val-Acc Target Data: 0.8272
05-26 22:09:50 The best model epoch 19, val-acc 0.8272
05-26 22:09:50 -----Epoch 20/30-----
05-26 22:09:50 current lr: [0.002, 0.002]
05-26 22:11:43 Train-Loss Source Classifier: 0.0332
05-26 22:11:43 Train-Loss MMD: 0.1019
05-26 22:11:43 Train-Loss L1: 0.0061
05-26 22:11:43 Train-Acc Source Data: 0.9906
05-26 22:12:09 Val-Acc Target Data: 0.8244
05-26 22:12:10 The best model epoch 19, val-acc 0.8272
05-26 22:12:10 -----Epoch 21/30-----
05-26 22:12:10 current lr: [0.0004, 0.0004]
05-26 22:13:09 Train-Loss Source Classifier: 0.0325
05-26 22:13:09 Train-Loss MMD: 0.1046
05-26 22:13:09 Train-Loss L1: 0.0059
05-26 22:13:09 Train-Acc Source Data: 0.9922
05-26 22:13:33 Val-Acc Target Data: 0.8217
05-26 22:13:34 The best model epoch 19, val-acc 0.8272
05-26 22:13:34 -----Epoch 22/30-----
05-26 22:13:34 current lr: [0.0004, 0.0004]
05-26 22:14:34 Train-Loss Source Classifier: 0.0286
05-26 22:14:34 Train-Loss MMD: 0.1038
05-26 22:14:34 Train-Loss L1: 0.0055
05-26 22:14:34 Train-Acc Source Data: 0.9924
05-26 22:15:00 Val-Acc Target Data: 0.8171
05-26 22:15:01 The best model epoch 19, val-acc 0.8272
05-26 22:15:01 -----Epoch 23/30-----
05-26 22:15:01 current lr: [0.0004, 0.0004]
05-26 22:16:00 Train-Loss Source Classifier: 0.0322
05-26 22:16:00 Train-Loss MMD: 0.1046
05-26 22:16:00 Train-Loss L1: 0.0053
05-26 22:16:00 Train-Acc Source Data: 0.9908
05-26 22:16:25 Val-Acc Target Data: 0.8208
05-26 22:16:26 The best model epoch 19, val-acc 0.8272
05-26 22:16:26 -----Epoch 24/30-----
05-26 22:16:26 current lr: [0.0004, 0.0004]
05-26 22:17:25 Train-Loss Source Classifier: 0.0291
05-26 22:17:25 Train-Loss MMD: 0.1038
05-26 22:17:25 Train-Loss L1: 0.0051
05-26 22:17:25 Train-Acc Source Data: 0.9926
05-26 22:17:52 Val-Acc Target Data: 0.8217
05-26 22:17:53 The best model epoch 19, val-acc 0.8272
05-26 22:17:53 -----Epoch 25/30-----
05-26 22:17:53 current lr: [0.0004, 0.0004]
05-26 22:19:18 Train-Loss Source Classifier: 0.0285
05-26 22:19:18 Train-Loss MMD: 0.1008
05-26 22:19:18 Train-Loss L1: 0.0051
05-26 22:19:18 Train-Acc Source Data: 0.9922
05-26 22:19:44 Val-Acc Target Data: 0.8254
05-26 22:19:44 The best model epoch 19, val-acc 0.8272
05-26 22:19:44 -----Epoch 26/30-----
05-26 22:19:44 current lr: [0.0004, 0.0004]
05-26 22:21:37 Train-Loss Source Classifier: 0.0281
05-26 22:21:37 Train-Loss MMD: 0.0989
05-26 22:21:37 Train-Loss L1: 0.0053
05-26 22:21:37 Train-Acc Source Data: 0.9917
05-26 22:22:02 Val-Acc Target Data: 0.8254
05-26 22:22:03 The best model epoch 19, val-acc 0.8272
05-26 22:22:03 -----Epoch 27/30-----
05-26 22:22:03 current lr: [0.0004, 0.0004]
05-26 22:23:02 Train-Loss Source Classifier: 0.0272
05-26 22:23:02 Train-Loss MMD: 0.1023
05-26 22:23:02 Train-Loss L1: 0.0051
05-26 22:23:02 Train-Acc Source Data: 0.9926
05-26 22:23:27 Val-Acc Target Data: 0.8272
05-26 22:23:28 The best model epoch 27, val-acc 0.8272
05-26 22:23:28 -----Epoch 28/30-----
05-26 22:23:28 current lr: [0.0004, 0.0004]
05-26 22:24:27 Train-Loss Source Classifier: 0.0266
05-26 22:24:27 Train-Loss MMD: 0.1018
05-26 22:24:27 Train-Loss L1: 0.0049
05-26 22:24:27 Train-Acc Source Data: 0.9938
05-26 22:24:52 Val-Acc Target Data: 0.8226
05-26 22:24:53 The best model epoch 27, val-acc 0.8272
05-26 22:24:53 -----Epoch 29/30-----
05-26 22:24:53 current lr: [0.0004, 0.0004]
05-26 22:25:53 Train-Loss Source Classifier: 0.0293
05-26 22:25:53 Train-Loss MMD: 0.1042
05-26 22:25:53 Train-Loss L1: 0.0047
05-26 22:25:53 Train-Acc Source Data: 0.9917
05-26 22:26:18 Val-Acc Target Data: 0.8244
05-26 22:26:19 The best model epoch 27, val-acc 0.8272
05-26 22:26:19 -----Epoch 30/30-----
05-26 22:26:19 current lr: [0.0004, 0.0004]
05-26 22:27:19 Train-Loss Source Classifier: 0.0257
05-26 22:27:19 Train-Loss MMD: 0.1007
05-26 22:27:19 Train-Loss L1: 0.0050
05-26 22:27:19 Train-Acc Source Data: 0.9944
05-26 22:27:44 Val-Acc Target Data: 0.8244
05-26 22:27:45 The best model epoch 27, val-acc 0.8272
05-26 22:27:45 Model saved to ./ckpt\MFSAN\multi_source\[CWRU_1CWRU_2CWRU_3]To[CWRU_0]_0526-213634.pth
