05-26 00:12:38 model_name: MFSAN
05-26 00:12:38 source: CWRU_0,CWRU_1
05-26 00:12:38 target: CWRU_2
05-26 00:12:38 data_dir: ./datasets
05-26 00:12:38 train_mode: multi_source
05-26 00:12:38 cuda_device: 0
05-26 00:12:38 save_dir: ./ckpt
05-26 00:12:38 max_epoch: 30
05-26 00:12:38 batch_size: 64
05-26 00:12:38 num_workers: 4
05-26 00:12:38 signal_size: 1024
05-26 00:12:38 random_state: 1
05-26 00:12:38 normlizetype: -1-1
05-26 00:12:38 opt: sgd
05-26 00:12:38 lr: 0.01
05-26 00:12:38 momentum: 0.9
05-26 00:12:38 betas: (0.9, 0.999)
05-26 00:12:38 weight_decay: 0.0005
05-26 00:12:38 lr_scheduler: stepLR
05-26 00:12:38 gamma: 0.2
05-26 00:12:38 steps: 10
05-26 00:12:38 tradeoff: ['exp', 'exp', 'exp']
05-26 00:12:38 dropout: 0.0
05-26 00:12:38 save: True
05-26 00:12:38 load_path: 
05-26 00:12:38 save_path: ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1]To[CWRU_2]_0526-001238
05-26 00:12:38 Detect 10 classes: ['B007', 'B014', 'B021', 'IR007', 'IR014', 'IR021', 'Normal', 'OR007', 'OR014', 'OR021']
05-26 00:12:38 using 1 / 1 gpus
05-26 00:12:40 Source set CWRU_0 number of samples 5668.
05-26 00:12:40 Source set CWRU_1 number of samples 9374.
05-26 00:12:40 Training set number of samples 7586.
05-26 00:12:40 Validation set number of samples 1902.
05-26 00:13:44 -----Epoch 1/30-----
05-26 00:13:44 current lr: [0.01, 0.01]
05-26 00:15:44 Train-Loss Source Classifier: 1.4775
05-26 00:15:44 Train-Loss MMD: 0.1220
05-26 00:15:44 Train-Loss L1: 0.0237
05-26 00:15:44 Train-Acc Source Data: 0.4681
05-26 00:16:11 Val-Acc Target Data: 0.6514
05-26 00:16:12 The best model epoch 1, val-acc 0.6514
05-26 00:16:12 -----Epoch 2/30-----
05-26 00:16:12 current lr: [0.01, 0.01]
05-26 00:18:05 Train-Loss Source Classifier: 0.5694
05-26 00:18:05 Train-Loss MMD: 0.1216
05-26 00:18:05 Train-Loss L1: 0.0283
05-26 00:18:05 Train-Acc Source Data: 0.7856
05-26 00:18:32 Val-Acc Target Data: 0.7850
05-26 00:18:33 The best model epoch 2, val-acc 0.7850
05-26 00:18:33 -----Epoch 3/30-----
05-26 00:18:33 current lr: [0.01, 0.01]
05-26 00:20:51 Train-Loss Source Classifier: 0.3260
05-26 00:20:51 Train-Loss MMD: 0.1200
05-26 00:20:51 Train-Loss L1: 0.0234
05-26 00:20:51 Train-Acc Source Data: 0.8773
05-26 00:21:18 Val-Acc Target Data: 0.7258
05-26 00:21:19 The best model epoch 2, val-acc 0.7850
05-26 00:21:19 -----Epoch 4/30-----
05-26 00:21:19 current lr: [0.01, 0.01]
05-26 00:22:47 Train-Loss Source Classifier: 0.1897
05-26 00:22:47 Train-Loss MMD: 0.1140
05-26 00:22:47 Train-Loss L1: 0.0182
05-26 00:22:47 Train-Acc Source Data: 0.9208
05-26 00:23:25 Val-Acc Target Data: 0.8028
05-26 00:23:26 The best model epoch 4, val-acc 0.8028
05-26 00:23:26 -----Epoch 5/30-----
05-26 00:23:26 current lr: [0.01, 0.01]
05-26 00:26:25 Train-Loss Source Classifier: 0.1646
05-26 00:26:25 Train-Loss MMD: 0.1098
05-26 00:26:25 Train-Loss L1: 0.0169
05-26 00:26:25 Train-Acc Source Data: 0.9335
05-26 00:26:54 Val-Acc Target Data: 0.8879
05-26 00:26:55 The best model epoch 5, val-acc 0.8879
05-26 00:26:55 -----Epoch 6/30-----
05-26 00:26:55 current lr: [0.01, 0.01]
05-26 00:28:43 Train-Loss Source Classifier: 0.1151
05-26 00:28:43 Train-Loss MMD: 0.1068
05-26 00:28:43 Train-Loss L1: 0.0150
05-26 00:28:43 Train-Acc Source Data: 0.9469
05-26 00:29:09 Val-Acc Target Data: 0.8939
05-26 00:29:10 The best model epoch 6, val-acc 0.8939
05-26 00:29:10 -----Epoch 7/30-----
05-26 00:29:10 current lr: [0.01, 0.01]
05-26 00:30:36 Train-Loss Source Classifier: 0.1092
05-26 00:30:36 Train-Loss MMD: 0.1077
05-26 00:30:36 Train-Loss L1: 0.0121
05-26 00:30:36 Train-Acc Source Data: 0.9472
05-26 00:31:08 Val-Acc Target Data: 0.8534
05-26 00:31:09 The best model epoch 6, val-acc 0.8939
05-26 00:31:09 -----Epoch 8/30-----
05-26 00:31:09 current lr: [0.01, 0.01]
05-26 00:33:30 Train-Loss Source Classifier: 0.0949
05-26 00:33:30 Train-Loss MMD: 0.1043
05-26 00:33:30 Train-Loss L1: 0.0110
05-26 00:33:30 Train-Acc Source Data: 0.9537
05-26 00:33:55 Val-Acc Target Data: 0.9520
05-26 00:33:56 The best model epoch 8, val-acc 0.9520
05-26 00:33:56 -----Epoch 9/30-----
05-26 00:33:56 current lr: [0.01, 0.01]
05-26 00:35:43 Train-Loss Source Classifier: 0.0787
05-26 00:35:43 Train-Loss MMD: 0.1029
05-26 00:35:43 Train-Loss L1: 0.0095
05-26 00:35:43 Train-Acc Source Data: 0.9579
05-26 00:36:09 Val-Acc Target Data: 0.8901
05-26 00:36:10 The best model epoch 8, val-acc 0.9520
05-26 00:36:10 -----Epoch 10/30-----
05-26 00:36:10 current lr: [0.01, 0.01]
05-26 00:37:59 Train-Loss Source Classifier: 0.0826
05-26 00:37:59 Train-Loss MMD: 0.1042
05-26 00:37:59 Train-Loss L1: 0.0089
05-26 00:37:59 Train-Acc Source Data: 0.9575
05-26 00:38:27 Val-Acc Target Data: 0.9440
05-26 00:38:28 The best model epoch 8, val-acc 0.9520
05-26 00:38:28 -----Epoch 11/30-----
05-26 00:38:28 current lr: [0.002, 0.002]
05-26 00:40:27 Train-Loss Source Classifier: 0.0532
05-26 00:40:27 Train-Loss MMD: 0.1007
05-26 00:40:27 Train-Loss L1: 0.0071
05-26 00:40:27 Train-Acc Source Data: 0.9649
05-26 00:40:52 Val-Acc Target Data: 0.9666
05-26 00:40:52 The best model epoch 11, val-acc 0.9666
05-26 00:40:52 -----Epoch 12/30-----
05-26 00:40:52 current lr: [0.002, 0.002]
05-26 00:42:40 Train-Loss Source Classifier: 0.0567
05-26 00:42:40 Train-Loss MMD: 0.0988
05-26 00:42:40 Train-Loss L1: 0.0064
05-26 00:42:40 Train-Acc Source Data: 0.9633
05-26 00:43:06 Val-Acc Target Data: 0.9677
05-26 00:43:07 The best model epoch 12, val-acc 0.9677
05-26 00:43:07 -----Epoch 13/30-----
05-26 00:43:07 current lr: [0.002, 0.002]
05-26 00:44:55 Train-Loss Source Classifier: 0.0516
05-26 00:44:55 Train-Loss MMD: 0.1002
05-26 00:44:55 Train-Loss L1: 0.0060
05-26 00:44:55 Train-Acc Source Data: 0.9688
05-26 00:45:21 Val-Acc Target Data: 0.9714
05-26 00:45:22 The best model epoch 13, val-acc 0.9714
05-26 00:45:22 -----Epoch 14/30-----
05-26 00:45:22 current lr: [0.002, 0.002]
05-26 00:47:08 Train-Loss Source Classifier: 0.0521
05-26 00:47:08 Train-Loss MMD: 0.0980
05-26 00:47:08 Train-Loss L1: 0.0057
05-26 00:47:08 Train-Acc Source Data: 0.9660
05-26 00:47:34 Val-Acc Target Data: 0.9704
05-26 00:47:35 The best model epoch 13, val-acc 0.9714
05-26 00:47:35 -----Epoch 15/30-----
05-26 00:47:35 current lr: [0.002, 0.002]
05-26 00:49:49 Train-Loss Source Classifier: 0.0516
05-26 00:49:49 Train-Loss MMD: 0.0989
05-26 00:49:49 Train-Loss L1: 0.0056
05-26 00:49:49 Train-Acc Source Data: 0.9674
05-26 00:50:14 Val-Acc Target Data: 0.9693
05-26 00:50:15 The best model epoch 13, val-acc 0.9714
05-26 00:50:15 -----Epoch 16/30-----
05-26 00:50:15 current lr: [0.002, 0.002]
05-26 00:51:38 Train-Loss Source Classifier: 0.0517
05-26 00:51:38 Train-Loss MMD: 0.0998
05-26 00:51:38 Train-Loss L1: 0.0054
05-26 00:51:38 Train-Acc Source Data: 0.9665
05-26 00:52:03 Val-Acc Target Data: 0.9677
05-26 00:52:04 The best model epoch 13, val-acc 0.9714
05-26 00:52:04 -----Epoch 17/30-----
05-26 00:52:04 current lr: [0.002, 0.002]
05-26 00:53:51 Train-Loss Source Classifier: 0.0503
05-26 00:53:51 Train-Loss MMD: 0.0968
05-26 00:53:51 Train-Loss L1: 0.0054
05-26 00:53:51 Train-Acc Source Data: 0.9664
05-26 00:54:16 Val-Acc Target Data: 0.9661
05-26 00:54:17 The best model epoch 13, val-acc 0.9714
05-26 00:54:17 -----Epoch 18/30-----
05-26 00:54:17 current lr: [0.002, 0.002]
05-26 00:56:29 Train-Loss Source Classifier: 0.0513
05-26 00:56:29 Train-Loss MMD: 0.0984
05-26 00:56:29 Train-Loss L1: 0.0055
05-26 00:56:29 Train-Acc Source Data: 0.9699
05-26 00:56:55 Val-Acc Target Data: 0.9704
05-26 00:56:56 The best model epoch 13, val-acc 0.9714
05-26 00:56:56 -----Epoch 19/30-----
05-26 00:56:56 current lr: [0.002, 0.002]
05-26 00:58:21 Train-Loss Source Classifier: 0.0492
05-26 00:58:21 Train-Loss MMD: 0.0953
05-26 00:58:21 Train-Loss L1: 0.0051
05-26 00:58:21 Train-Acc Source Data: 0.9699
05-26 00:58:46 Val-Acc Target Data: 0.9666
05-26 00:58:47 The best model epoch 13, val-acc 0.9714
05-26 00:58:47 -----Epoch 20/30-----
05-26 00:58:47 current lr: [0.002, 0.002]
05-26 01:00:59 Train-Loss Source Classifier: 0.0496
05-26 01:00:59 Train-Loss MMD: 0.0957
05-26 01:00:59 Train-Loss L1: 0.0050
05-26 01:00:59 Train-Acc Source Data: 0.9682
05-26 01:01:25 Val-Acc Target Data: 0.9661
05-26 01:01:26 The best model epoch 13, val-acc 0.9714
05-26 01:01:26 -----Epoch 21/30-----
05-26 01:01:26 current lr: [0.0004, 0.0004]
05-26 01:03:16 Train-Loss Source Classifier: 0.0507
05-26 01:03:16 Train-Loss MMD: 0.0987
05-26 01:03:16 Train-Loss L1: 0.0047
05-26 01:03:16 Train-Acc Source Data: 0.9657
05-26 01:03:42 Val-Acc Target Data: 0.9671
05-26 01:03:43 The best model epoch 13, val-acc 0.9714
05-26 01:03:43 -----Epoch 22/30-----
05-26 01:03:43 current lr: [0.0004, 0.0004]
05-26 01:05:09 Train-Loss Source Classifier: 0.0507
05-26 01:05:09 Train-Loss MMD: 0.0959
05-26 01:05:09 Train-Loss L1: 0.0049
05-26 01:05:09 Train-Acc Source Data: 0.9674
05-26 01:05:40 Val-Acc Target Data: 0.9677
05-26 01:05:41 The best model epoch 13, val-acc 0.9714
05-26 01:05:41 -----Epoch 23/30-----
05-26 01:05:41 current lr: [0.0004, 0.0004]
05-26 01:07:54 Train-Loss Source Classifier: 0.0490
05-26 01:07:54 Train-Loss MMD: 0.0958
05-26 01:07:54 Train-Loss L1: 0.0047
05-26 01:07:54 Train-Acc Source Data: 0.9711
05-26 01:08:19 Val-Acc Target Data: 0.9677
05-26 01:08:20 The best model epoch 13, val-acc 0.9714
05-26 01:08:20 -----Epoch 24/30-----
05-26 01:08:20 current lr: [0.0004, 0.0004]
05-26 01:10:07 Train-Loss Source Classifier: 0.0481
05-26 01:10:07 Train-Loss MMD: 0.0960
05-26 01:10:07 Train-Loss L1: 0.0048
05-26 01:10:07 Train-Acc Source Data: 0.9693
05-26 01:10:33 Val-Acc Target Data: 0.9682
05-26 01:10:34 The best model epoch 13, val-acc 0.9714
05-26 01:10:34 -----Epoch 25/30-----
05-26 01:10:34 current lr: [0.0004, 0.0004]
05-26 01:12:23 Train-Loss Source Classifier: 0.0510
05-26 01:12:23 Train-Loss MMD: 0.0939
05-26 01:12:23 Train-Loss L1: 0.0048
05-26 01:12:23 Train-Acc Source Data: 0.9648
05-26 01:12:49 Val-Acc Target Data: 0.9693
05-26 01:12:50 The best model epoch 13, val-acc 0.9714
05-26 01:12:50 -----Epoch 26/30-----
05-26 01:12:50 current lr: [0.0004, 0.0004]
05-26 01:14:36 Train-Loss Source Classifier: 0.0475
05-26 01:14:36 Train-Loss MMD: 0.0971
05-26 01:14:36 Train-Loss L1: 0.0049
05-26 01:14:36 Train-Acc Source Data: 0.9686
05-26 01:15:00 Val-Acc Target Data: 0.9682
05-26 01:15:01 The best model epoch 13, val-acc 0.9714
05-26 01:15:01 -----Epoch 27/30-----
05-26 01:15:01 current lr: [0.0004, 0.0004]
05-26 01:16:48 Train-Loss Source Classifier: 0.0495
05-26 01:16:48 Train-Loss MMD: 0.0931
05-26 01:16:48 Train-Loss L1: 0.0047
05-26 01:16:48 Train-Acc Source Data: 0.9691
05-26 01:17:16 Val-Acc Target Data: 0.9666
05-26 01:17:17 The best model epoch 13, val-acc 0.9714
05-26 01:17:17 -----Epoch 28/30-----
05-26 01:17:17 current lr: [0.0004, 0.0004]
05-26 01:19:05 Train-Loss Source Classifier: 0.0488
05-26 01:19:05 Train-Loss MMD: 0.0986
05-26 01:19:05 Train-Loss L1: 0.0047
05-26 01:19:05 Train-Acc Source Data: 0.9678
05-26 01:19:29 Val-Acc Target Data: 0.9661
05-26 01:19:30 The best model epoch 13, val-acc 0.9714
05-26 01:19:30 -----Epoch 29/30-----
05-26 01:19:30 current lr: [0.0004, 0.0004]
05-26 01:21:16 Train-Loss Source Classifier: 0.0494
05-26 01:21:16 Train-Loss MMD: 0.0969
05-26 01:21:16 Train-Loss L1: 0.0048
05-26 01:21:16 Train-Acc Source Data: 0.9662
05-26 01:21:40 Val-Acc Target Data: 0.9666
05-26 01:21:41 The best model epoch 13, val-acc 0.9714
05-26 01:21:41 -----Epoch 30/30-----
05-26 01:21:41 current lr: [0.0004, 0.0004]
05-26 01:23:58 Train-Loss Source Classifier: 0.0501
05-26 01:23:58 Train-Loss MMD: 0.0954
05-26 01:23:58 Train-Loss L1: 0.0048
05-26 01:23:58 Train-Acc Source Data: 0.9677
05-26 01:24:23 Val-Acc Target Data: 0.9688
05-26 01:24:24 The best model epoch 13, val-acc 0.9714
05-26 01:24:24 Model saved to ./ckpt\MFSAN\multi_source\[CWRU_0CWRU_1]To[CWRU_2]_0526-001238.pth
