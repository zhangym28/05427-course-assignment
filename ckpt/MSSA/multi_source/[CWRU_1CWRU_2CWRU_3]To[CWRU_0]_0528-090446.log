05-28 09:04:46 model_name: MSSA
05-28 09:04:46 source: CWRU_1,CWRU_2,CWRU_3
05-28 09:04:46 target: CWRU_0
05-28 09:04:46 data_dir: ./datasets
05-28 09:04:46 train_mode: multi_source
05-28 09:04:46 cuda_device: 0
05-28 09:04:46 save_dir: ./ckpt
05-28 09:04:46 max_epoch: 30
05-28 09:04:46 batch_size: 64
05-28 09:04:46 num_workers: 4
05-28 09:04:46 signal_size: 1024
05-28 09:04:46 random_state: 1
05-28 09:04:46 normlizetype: -1-1
05-28 09:04:46 opt: sgd
05-28 09:04:46 lr: 0.01
05-28 09:04:46 momentum: 0.9
05-28 09:04:46 betas: (0.9, 0.999)
05-28 09:04:46 weight_decay: 0.0005
05-28 09:04:46 lr_scheduler: stepLR
05-28 09:04:46 gamma: 0.2
05-28 09:04:46 steps: 10
05-28 09:04:46 tradeoff: ['exp', 'exp', 'exp']
05-28 09:04:46 dropout: 0.0
05-28 09:04:46 save: True
05-28 09:04:46 load_path: 
05-28 09:04:46 save_path: ./ckpt\MSSA\multi_source\[CWRU_1CWRU_2CWRU_3]To[CWRU_0]_0528-090446
05-28 09:04:46 Detect 10 classes: ['B007', 'B014', 'B021', 'IR007', 'IR014', 'IR021', 'Normal', 'OR007', 'OR014', 'OR021']
05-28 09:04:46 using 1 / 1 gpus
05-28 09:04:52 Source set CWRU_1 number of samples 9374.
05-28 09:04:52 Source set CWRU_2 number of samples 9488.
05-28 09:04:52 Source set CWRU_3 number of samples 9492.
05-28 09:04:52 Training set number of samples 4532.
05-28 09:04:52 Validation set number of samples 1136.
05-28 09:06:14 -----Epoch 1/30-----
05-28 09:06:14 current lr: [0.01, 0.01]
05-28 09:14:52 Train-Loss Source Classifier: 4.0906
05-28 09:14:52 Train-Loss MMD: 0.4693
05-28 09:14:52 Train-Acc Source Data 0: 0.5290
05-28 09:14:52 Train-Acc Source Data 1: 0.5054
05-28 09:14:52 Train-Acc Source Data 2: 0.5190
05-28 09:15:41 Val-Acc Target Data: 0.4623
05-28 09:15:42 The best model epoch 1, val-acc 0.4623
05-28 09:15:42 -----Epoch 2/30-----
05-28 09:15:42 current lr: [0.01, 0.01]
05-28 09:25:35 Train-Loss Source Classifier: 1.2543
05-28 09:25:35 Train-Loss MMD: 0.4548
05-28 09:25:35 Train-Acc Source Data 0: 0.8377
05-28 09:25:35 Train-Acc Source Data 1: 0.8469
05-28 09:25:35 Train-Acc Source Data 2: 0.8462
05-28 09:26:14 Val-Acc Target Data: 0.5993
05-28 09:26:15 The best model epoch 2, val-acc 0.5993
05-28 09:26:15 -----Epoch 3/30-----
05-28 09:26:15 current lr: [0.01, 0.01]
05-28 09:39:54 Train-Loss Source Classifier: 0.5584
05-28 09:39:54 Train-Loss MMD: 0.4118
05-28 09:39:54 Train-Acc Source Data 0: 0.9232
05-28 09:39:54 Train-Acc Source Data 1: 0.9460
05-28 09:39:54 Train-Acc Source Data 2: 0.9362
05-28 09:40:34 Val-Acc Target Data: 0.7445
05-28 09:40:35 The best model epoch 3, val-acc 0.7445
05-28 09:40:35 -----Epoch 4/30-----
05-28 09:40:35 current lr: [0.01, 0.01]
05-28 09:51:26 Train-Loss Source Classifier: 0.3393
05-28 09:51:26 Train-Loss MMD: 0.3812
05-28 09:51:26 Train-Acc Source Data 0: 0.9607
05-28 09:51:26 Train-Acc Source Data 1: 0.9658
05-28 09:51:26 Train-Acc Source Data 2: 0.9605
05-28 09:51:55 Val-Acc Target Data: 0.6801
05-28 09:51:56 The best model epoch 3, val-acc 0.7445
05-28 09:51:56 -----Epoch 5/30-----
05-28 09:51:56 current lr: [0.01, 0.01]
05-28 10:03:56 Train-Loss Source Classifier: 0.2724
05-28 10:03:56 Train-Loss MMD: 0.3594
05-28 10:03:56 Train-Acc Source Data 0: 0.9672
05-28 10:03:56 Train-Acc Source Data 1: 0.9746
05-28 10:03:56 Train-Acc Source Data 2: 0.9667
05-28 10:04:22 Val-Acc Target Data: 0.7123
05-28 10:04:23 The best model epoch 3, val-acc 0.7445
05-28 10:04:23 -----Epoch 6/30-----
05-28 10:04:23 current lr: [0.01, 0.01]
05-28 10:14:54 Train-Loss Source Classifier: 0.1777
05-28 10:14:54 Train-Loss MMD: 0.3413
05-28 10:14:54 Train-Acc Source Data 0: 0.9786
05-28 10:14:54 Train-Acc Source Data 1: 0.9815
05-28 10:14:54 Train-Acc Source Data 2: 0.9815
05-28 10:15:32 Val-Acc Target Data: 0.7574
05-28 10:15:33 The best model epoch 6, val-acc 0.7574
05-28 10:15:33 -----Epoch 7/30-----
05-28 10:15:33 current lr: [0.01, 0.01]
05-28 10:28:58 Train-Loss Source Classifier: 0.1383
05-28 10:28:58 Train-Loss MMD: 0.3291
05-28 10:28:58 Train-Acc Source Data 0: 0.9830
05-28 10:28:58 Train-Acc Source Data 1: 0.9877
05-28 10:28:58 Train-Acc Source Data 2: 0.9808
05-28 10:29:25 Val-Acc Target Data: 0.7693
05-28 10:29:26 The best model epoch 7, val-acc 0.7693
05-28 10:29:26 -----Epoch 8/30-----
05-28 10:29:26 current lr: [0.01, 0.01]
05-28 10:40:39 Train-Loss Source Classifier: 0.0847
05-28 10:40:39 Train-Loss MMD: 0.3351
05-28 10:40:39 Train-Acc Source Data 0: 0.9875
05-28 10:40:39 Train-Acc Source Data 1: 0.9940
05-28 10:40:39 Train-Acc Source Data 2: 0.9911
05-28 10:41:10 Val-Acc Target Data: 0.7022
05-28 10:41:11 The best model epoch 7, val-acc 0.7693
05-28 10:41:11 -----Epoch 9/30-----
05-28 10:41:11 current lr: [0.01, 0.01]
05-28 10:54:42 Train-Loss Source Classifier: 0.0750
05-28 10:54:42 Train-Loss MMD: 0.3219
05-28 10:54:42 Train-Acc Source Data 0: 0.9913
05-28 10:54:42 Train-Acc Source Data 1: 0.9940
05-28 10:54:42 Train-Acc Source Data 2: 0.9913
05-28 10:55:11 Val-Acc Target Data: 0.7142
05-28 10:55:12 The best model epoch 7, val-acc 0.7693
05-28 10:55:12 -----Epoch 10/30-----
05-28 10:55:12 current lr: [0.01, 0.01]
05-28 11:06:26 Train-Loss Source Classifier: 0.0672
05-28 11:06:26 Train-Loss MMD: 0.3150
05-28 11:06:26 Train-Acc Source Data 0: 0.9922
05-28 11:06:26 Train-Acc Source Data 1: 0.9942
05-28 11:06:26 Train-Acc Source Data 2: 0.9944
05-28 11:07:03 Val-Acc Target Data: 0.8051
05-28 11:07:04 The best model epoch 10, val-acc 0.8051
05-28 11:07:04 -----Epoch 11/30-----
05-28 11:07:04 current lr: [0.002, 0.002]
05-28 11:20:22 Train-Loss Source Classifier: 0.0281
05-28 11:20:22 Train-Loss MMD: 0.3017
05-28 11:20:22 Train-Acc Source Data 0: 0.9978
05-28 11:20:22 Train-Acc Source Data 1: 0.9980
05-28 11:20:22 Train-Acc Source Data 2: 0.9982
05-28 11:20:48 Val-Acc Target Data: 0.8263
05-28 11:20:49 The best model epoch 11, val-acc 0.8263
05-28 11:20:49 -----Epoch 12/30-----
05-28 11:20:49 current lr: [0.002, 0.002]
05-28 11:31:59 Train-Loss Source Classifier: 0.0188
05-28 11:31:59 Train-Loss MMD: 0.2992
05-28 11:31:59 Train-Acc Source Data 0: 0.9989
05-28 11:31:59 Train-Acc Source Data 1: 1.0000
05-28 11:31:59 Train-Acc Source Data 2: 0.9982
05-28 11:32:28 Val-Acc Target Data: 0.8226
05-28 11:32:29 The best model epoch 11, val-acc 0.8263
05-28 11:32:29 -----Epoch 13/30-----
05-28 11:32:29 current lr: [0.002, 0.002]
05-28 11:45:20 Train-Loss Source Classifier: 0.0174
05-28 11:45:20 Train-Loss MMD: 0.2951
05-28 11:45:20 Train-Acc Source Data 0: 0.9998
05-28 11:45:20 Train-Acc Source Data 1: 0.9998
05-28 11:45:20 Train-Acc Source Data 2: 0.9998
05-28 11:45:46 Val-Acc Target Data: 0.8244
05-28 11:45:47 The best model epoch 11, val-acc 0.8263
05-28 11:45:47 -----Epoch 14/30-----
05-28 11:45:47 current lr: [0.002, 0.002]
05-28 11:56:58 Train-Loss Source Classifier: 0.0178
05-28 11:56:58 Train-Loss MMD: 0.2795
05-28 11:56:58 Train-Acc Source Data 0: 0.9998
05-28 11:56:58 Train-Acc Source Data 1: 0.9996
05-28 11:56:58 Train-Acc Source Data 2: 0.9996
05-28 11:57:24 Val-Acc Target Data: 0.8244
05-28 11:57:25 The best model epoch 11, val-acc 0.8263
05-28 11:57:25 -----Epoch 15/30-----
05-28 11:57:25 current lr: [0.002, 0.002]
05-28 12:10:08 Train-Loss Source Classifier: 0.0180
05-28 12:10:08 Train-Loss MMD: 0.2809
05-28 12:10:08 Train-Acc Source Data 0: 0.9998
05-28 12:10:08 Train-Acc Source Data 1: 0.9998
05-28 12:10:08 Train-Acc Source Data 2: 0.9998
05-28 12:10:35 Val-Acc Target Data: 0.8079
05-28 12:10:36 The best model epoch 11, val-acc 0.8263
05-28 12:10:36 -----Epoch 16/30-----
05-28 12:10:36 current lr: [0.002, 0.002]
05-28 12:23:19 Train-Loss Source Classifier: 0.0197
05-28 12:23:19 Train-Loss MMD: 0.2846
05-28 12:23:19 Train-Acc Source Data 0: 0.9996
05-28 12:23:19 Train-Acc Source Data 1: 0.9998
05-28 12:23:19 Train-Acc Source Data 2: 0.9998
05-28 12:23:48 Val-Acc Target Data: 0.8226
05-28 12:23:49 The best model epoch 11, val-acc 0.8263
05-28 12:23:49 -----Epoch 17/30-----
05-28 12:23:49 current lr: [0.002, 0.002]
05-28 12:36:38 Train-Loss Source Classifier: 0.0201
05-28 12:36:38 Train-Loss MMD: 0.2692
05-28 12:36:38 Train-Acc Source Data 0: 1.0000
05-28 12:36:38 Train-Acc Source Data 1: 1.0000
05-28 12:36:38 Train-Acc Source Data 2: 1.0000
05-28 12:36:59 Val-Acc Target Data: 0.8189
05-28 12:36:59 The best model epoch 11, val-acc 0.8263
05-28 12:36:59 -----Epoch 18/30-----
05-28 12:36:59 current lr: [0.002, 0.002]
05-28 12:46:12 Train-Loss Source Classifier: 0.0202
05-28 12:46:12 Train-Loss MMD: 0.2802
05-28 12:46:12 Train-Acc Source Data 0: 1.0000
05-28 12:46:12 Train-Acc Source Data 1: 0.9998
05-28 12:46:12 Train-Acc Source Data 2: 0.9998
05-28 12:46:40 Val-Acc Target Data: 0.8116
05-28 12:46:41 The best model epoch 11, val-acc 0.8263
05-28 12:46:41 -----Epoch 19/30-----
05-28 12:46:41 current lr: [0.002, 0.002]
05-28 12:56:09 Train-Loss Source Classifier: 0.0201
05-28 12:56:09 Train-Loss MMD: 0.2703
05-28 12:56:09 Train-Acc Source Data 0: 1.0000
05-28 12:56:09 Train-Acc Source Data 1: 0.9998
05-28 12:56:09 Train-Acc Source Data 2: 1.0000
05-28 12:56:37 Val-Acc Target Data: 0.8015
05-28 12:56:38 The best model epoch 11, val-acc 0.8263
05-28 12:56:38 -----Epoch 20/30-----
05-28 12:56:38 current lr: [0.002, 0.002]
05-28 13:04:51 Train-Loss Source Classifier: 0.0218
05-28 13:04:51 Train-Loss MMD: 0.2645
05-28 13:04:51 Train-Acc Source Data 0: 1.0000
05-28 13:04:51 Train-Acc Source Data 1: 1.0000
05-28 13:04:51 Train-Acc Source Data 2: 1.0000
05-28 13:05:20 Val-Acc Target Data: 0.7987
05-28 13:05:21 The best model epoch 11, val-acc 0.8263
05-28 13:05:21 -----Epoch 21/30-----
05-28 13:05:21 current lr: [0.0004, 0.0004]
05-28 13:12:34 Train-Loss Source Classifier: 0.0228
05-28 13:12:34 Train-Loss MMD: 0.2561
05-28 13:12:34 Train-Acc Source Data 0: 0.9998
05-28 13:12:34 Train-Acc Source Data 1: 1.0000
05-28 13:12:34 Train-Acc Source Data 2: 1.0000
05-28 13:13:00 Val-Acc Target Data: 0.8070
05-28 13:13:01 The best model epoch 11, val-acc 0.8263
05-28 13:13:01 -----Epoch 22/30-----
05-28 13:13:01 current lr: [0.0004, 0.0004]
05-28 13:20:58 Train-Loss Source Classifier: 0.0217
05-28 13:20:58 Train-Loss MMD: 0.2538
05-28 13:20:58 Train-Acc Source Data 0: 1.0000
05-28 13:20:58 Train-Acc Source Data 1: 1.0000
05-28 13:20:58 Train-Acc Source Data 2: 1.0000
05-28 13:21:24 Val-Acc Target Data: 0.8116
05-28 13:21:25 The best model epoch 11, val-acc 0.8263
05-28 13:21:25 -----Epoch 23/30-----
05-28 13:21:25 current lr: [0.0004, 0.0004]
05-28 13:28:36 Train-Loss Source Classifier: 0.0231
05-28 13:28:36 Train-Loss MMD: 0.2538
05-28 13:28:36 Train-Acc Source Data 0: 0.9998
05-28 13:28:36 Train-Acc Source Data 1: 1.0000
05-28 13:28:36 Train-Acc Source Data 2: 0.9996
05-28 13:29:04 Val-Acc Target Data: 0.8088
05-28 13:29:05 The best model epoch 11, val-acc 0.8263
05-28 13:29:05 -----Epoch 24/30-----
05-28 13:29:05 current lr: [0.0004, 0.0004]
05-28 13:36:59 Train-Loss Source Classifier: 0.0222
05-28 13:36:59 Train-Loss MMD: 0.2573
05-28 13:36:59 Train-Acc Source Data 0: 0.9998
05-28 13:36:59 Train-Acc Source Data 1: 1.0000
05-28 13:36:59 Train-Acc Source Data 2: 1.0000
05-28 13:37:25 Val-Acc Target Data: 0.8097
05-28 13:37:26 The best model epoch 11, val-acc 0.8263
05-28 13:37:26 -----Epoch 25/30-----
05-28 13:37:26 current lr: [0.0004, 0.0004]
05-28 13:45:04 Train-Loss Source Classifier: 0.0225
05-28 13:45:04 Train-Loss MMD: 0.2599
05-28 13:45:04 Train-Acc Source Data 0: 1.0000
05-28 13:45:04 Train-Acc Source Data 1: 1.0000
05-28 13:45:04 Train-Acc Source Data 2: 1.0000
05-28 13:45:29 Val-Acc Target Data: 0.8125
05-28 13:45:30 The best model epoch 11, val-acc 0.8263
05-28 13:45:30 -----Epoch 26/30-----
05-28 13:45:30 current lr: [0.0004, 0.0004]
05-28 13:56:09 Train-Loss Source Classifier: 0.0228
05-28 13:56:09 Train-Loss MMD: 0.2554
05-28 13:56:09 Train-Acc Source Data 0: 1.0000
05-28 13:56:09 Train-Acc Source Data 1: 1.0000
05-28 13:56:09 Train-Acc Source Data 2: 0.9998
05-28 13:56:35 Val-Acc Target Data: 0.8070
05-28 13:56:36 The best model epoch 11, val-acc 0.8263
05-28 13:56:36 -----Epoch 27/30-----
05-28 13:56:36 current lr: [0.0004, 0.0004]
05-28 14:06:21 Train-Loss Source Classifier: 0.0231
05-28 14:06:21 Train-Loss MMD: 0.2479
05-28 14:06:21 Train-Acc Source Data 0: 1.0000
05-28 14:06:21 Train-Acc Source Data 1: 1.0000
05-28 14:06:21 Train-Acc Source Data 2: 1.0000
05-28 14:07:00 Val-Acc Target Data: 0.8134
05-28 14:07:00 The best model epoch 11, val-acc 0.8263
05-28 14:07:00 -----Epoch 28/30-----
05-28 14:07:00 current lr: [0.0004, 0.0004]
05-28 14:20:35 Train-Loss Source Classifier: 0.0230
05-28 14:20:35 Train-Loss MMD: 0.2474
05-28 14:20:35 Train-Acc Source Data 0: 1.0000
05-28 14:20:35 Train-Acc Source Data 1: 1.0000
05-28 14:20:35 Train-Acc Source Data 2: 1.0000
05-28 14:21:02 Val-Acc Target Data: 0.8070
05-28 14:21:02 The best model epoch 11, val-acc 0.8263
05-28 14:21:02 -----Epoch 29/30-----
05-28 14:21:02 current lr: [0.0004, 0.0004]
05-28 14:32:40 Train-Loss Source Classifier: 0.0233
05-28 14:32:40 Train-Loss MMD: 0.2451
05-28 14:32:40 Train-Acc Source Data 0: 1.0000
05-28 14:32:40 Train-Acc Source Data 1: 1.0000
05-28 14:32:40 Train-Acc Source Data 2: 1.0000
05-28 14:33:07 Val-Acc Target Data: 0.8107
05-28 14:33:08 The best model epoch 11, val-acc 0.8263
05-28 14:33:08 -----Epoch 30/30-----
05-28 14:33:08 current lr: [0.0004, 0.0004]
05-28 14:46:05 Train-Loss Source Classifier: 0.0237
05-28 14:46:05 Train-Loss MMD: 0.2443
05-28 14:46:05 Train-Acc Source Data 0: 1.0000
05-28 14:46:05 Train-Acc Source Data 1: 1.0000
05-28 14:46:05 Train-Acc Source Data 2: 1.0000
05-28 14:46:41 Val-Acc Target Data: 0.8061
05-28 14:46:41 The best model epoch 11, val-acc 0.8263
05-28 14:46:42 Model saved to ./ckpt\MSSA\multi_source\[CWRU_1CWRU_2CWRU_3]To[CWRU_0]_0528-090446.pth
